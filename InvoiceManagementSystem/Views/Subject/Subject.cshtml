
@{
    ViewBag.Title = "Subject";
}

<head>
    <meta charset="utf-8">
    <link rel="apple-touch-icon" sizes="76x76" href="https://demos.creative-tim.com/argon-design-system-pro/assets/img/apple-icon.png">
    <link rel="icon" href="https://demos.creative-tim.com/argon-design-system-pro/assets/img/apple-icon.png" type="image/png">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Creative Tim">
    <title>
    </title>
    <link rel="canonical" href="https://www.creative-tim.com/learning-lab/bootstrap/choices/argon-dashboard" />

    <meta name="description" content="A vanilla JS customisable select box/text input plugin.">
    <meta name="twitter:card" content="product">
    <meta name="twitter:description" content="A vanilla JS customisable select box/text input plugin.">

    <meta name="twitter:image" content="https://s3.amazonaws.com/creativetim_bucket/products/137/original/opt_adp_thumbnail.jpg">
    <meta property="fb:app_id" content="655968634437471">
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://demos.creative-tim.com/argon-dashboard/index.html" />
    <meta property="og:image" content="https://s3.amazonaws.com/creativetim_bucket/products/137/original/opt_adp_thumbnail.jpg" />
    <meta property="og:description" content="A vanilla JS customisable select box/text input plugin." />
    <meta property="og:site_name" content="Creative Tim" />
    <link rel="stylesheet" href="https://demos.creative-tim.com/argon-design-system-pro/assets/css/nucleo-icons.css" type="text/css">

    <link rel="stylesheet" href="https://demos.creative-tim.com/test/argon-dashboard-pro/assets/css/argon-dashboard.min.css?v=2.0.0" type="text/css">
    <link href="https://demos.creative-tim.com/test/argon-dashboard-pro/assets/css/argon-dashboard.min.css?v=2.0.0" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
    <link href="https://demos.creative-tim.com/argon-design-system-pro/assets/css/nucleo-icons.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>



    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
    <link href="../../assets/docs-soft.css" rel="stylesheet" />
</head>
<nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl " id="navbarBlur" data-scroll="false">
    <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
            <h5 class="font-weight-bolder text-white mb-0" style="margin-top:25px"><i class="fa fa-book text-lg" style="color:white"></i>&nbsp;&nbsp;Subject List</h5>
        </nav>
    </div>
</nav>

<div class="row" id="FilterDiv" style="margin-left:19px">
    <div class="col-sm-6 col-md-3">
        <div class="form-group form-focus">
            <input type="text" class="form-control form-control-alternative" id="SearchText" placeholder="Search" maxlength="50">
        </div>
    </div>

    <div class="col-sm-6 col-md-3">
        <div class="form-group form-focus">
            <select data-placeholder="Select here.." id="ddlClassId" class="select2-single-placeholder form-control form-control-alternative" style="width: 100%"></select>
        </div>
    </div>
    <div class="col-sm-6 col-md-3">
        <div class="form-group form-focus select-focus">
            <select tabindex="1" data-placeholder="Select here.." id="intActive" name="intActive" class="form-control form-control-alternative floating">
                <option value="3">Select Status</option>
                <option value="1">Active</option>
                <option value="2">In-Active</option>
            </select>
        </div>
    </div>
    <div class="col-sm-6 col-md-1">
        <a href="#" class="btn bg-gradient-success btn-tooltip" data-bs-toggle="tooltip" data-bs-placement="top" title="Search" data-container="body" data-animation="true" onclick="GetSubjectList(1)"><i class="fa fa-search" style="color:white"></i></a>
        @*<a class="btn bg-gradient-success btn-tooltip" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Filter" onclick="GetSubjectList(1)"><i class="fa fa-search" style="color:white"></i></a>*@
    </div>
    <div class="col-sm-3 col-md-1">
        <a class="btn bg-gradient-secondary" title="Clear" onclick="ClearData(2)"><i class="fa fa-remove" style="color:white"></i></a>

    </div>
</div>

<div class="row">
    <div style="margin-left:868px">
        <a href="#" class="btn bg-gradient-dark" onclick="ShowFilter()" title="Filter"><i class="fa fa-filter"></i></a>
        @*<a href="#" class="btn bg-gradient-dark" onclick="ShowFilter()" style="margin-left: 843px; margin-bottom: -64px;"><i class="fa fa-filter"></i></a>*@
        <a class="btn bg-gradient-info" title="Add Subject" data-bs-toggle="modal" data-bs-target="#Subject" onclick="Clear()"><i class="fa fa-plus" style="color:white"></i>&nbsp;Add Subject </a>
    </div>
</div>

<div class="container-fluid py-4">
    <div class="row">
        <div class="col-sm-12 col-md-12">
            <div class="dataTables_length" id="DataTables_Table_0_length">
                <label style="color:white">
                    Show
                    <select id="PageSize" onchange="GetSubjectList(1)" class="drpselect">
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select> entries
                </label>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="card mb-4">
                <div class="card-header pb-0">
                    <h6>Subject List</h6>
                </div>
                <div class="card-body px-0 pt-0 pb-2">
                    <div class="table-responsive p-0">
                        <div id="tblBody"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="Subject" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" style="margin-left:173px"><span id="PopupTitle">Add Subject</span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color:black">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="basicinput"><b>Class Room</b></label>
                            <select class="form-control" id="ClassId">
                                <option value="0">Select ClassRoom</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="example-text-input" class="form-control-label">Subject Name <span class="text-danger">*</span></label>
                            <input class="form-control" type="text" id="SubjectName" placeholder="Enter Subject Name">
                            <span id="errSubjectName" class="text-xs font-weight-bold mb-0" style="color:red"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnAdd" class="btn bg-gradient-info" onclick="InsertData()"><i class="fa fa-save" style="color:white"></i>&nbsp;Add</button>
                <button type="button" class="btn bg-gradient-dark" onclick="ClearData(1)"><i class="fa fa-remove" style="color:white"></i>&nbsp;Clear</button>
                <input type="hidden" id="hdnintId" value="0" />
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="delete_Subject" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" style="margin-left:132px"><span id="PopupTitle">Delete Subject</span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color:black">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p style="margin-left:70px">Are you sure want to delete this Subject ?.</p>
            </div>
            <div class="modal-footer" style="padding-right: 166px">
                <button type="button" id="btnAdd" class="btn bg-gradient-danger" onclick="deleteSubject()">Delete</button>
                <button type="button" class="btn bg-gradient-dark" data-bs-dismiss="modal">Cancel</button>
                <input type="hidden" id="hdnintId" value="0" />
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="status" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" style="margin-left:132px"><span id="PopupTitle">Status Confirmation</span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p style="margin-left:98px">Are you sure want to change status?</p>
            </div>
            <div class="modal-footer" style="padding-right: 146px">
                <button type="button" id="btnAdd" class="btn bg-gradient-info" onclick="UpdateStatus()">Change</button>
                <button type="button" class="btn bg-gradient-dark" data-bs-dismiss="modal">Cancel</button>

            </div>
        </div>
    </div>
</div>
<script src="https://demos.creative-tim.com/argon-dashboard-pro-bs4/assets/vendor/jquery/dist/jquery.min.js" type="text/javascript"></script>
<script src="https://demos.creative-tim.com/soft-ui-design-system-pro/assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="https://demos.creative-tim.com/soft-ui-design-system-pro/assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<script src="https://demos.creative-tim.com/argon-dashboard-pro-bs4/assets/vendor/prismjs/prism.js" type="text/javascript"></script>
<script src="https://demos.creative-tim.com/argon-design-system-pro/assets/demo/docs.min.js" type="text/javascript"></script>
<script src="https://demos.creative-tim.com/argon-design-system-pro/assets/demo/vendor/holder.min.js" type="text/javascript"></script>
<script src="https://demos.creative-tim.com/soft-ui-design-system-pro/assets/js/plugins/moment.min.js" type="text/javascript"></script>
<script src="https://demos.creative-tim.com/soft-ui-design-system-pro/assets/js/plugins/choices.min.js" type="text/javascript"></script>
<script src="https://demos.creative-tim.com/test/argon-dashboard-pro/assets/js/argon-dashboard.min.js?v=1.0.0" type="text/javascript"></script>


<script src="../../assets/docs.js"></script>
<script type="text/javascript">
    if (document.getElementById('choices-button')) {
        var element = document.getElementById('choices-button');
        const example = new Choices(element, {});
    }
    var choicesTags = document.getElementById('choices-tags');
    var color = choicesTags.dataset.color;
    if (choicesTags) {
        const example = new Choices(choicesTags, {
            delimiter: ',',
            editItems: true,
            maxItemCount: 5,
            removeItemButton: true,
            addItems: true,
            classNames: {
                item: 'badge rounded-pill choices-' + color + ' me-2'
            }
        });
    }
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/v52afc6f149f6479b8c77fa569edb01181681764108816" integrity="sha512-jGCTpDpBAYDGNYR5ztKt4BQPGef1P0giN6ZGVUi835kFF88FOmmn8jBQWNgrNd8g/Yu421NdgWhwQoaOPFflDw==" data-cf-beacon='{"rayId":"7e4f6f4d987a5fad","version":"2023.4.0","r":1,"token":"1b7cbb72744b40c580f8633c6b62637e","si":100}' crossorigin="anonymous"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<script src="~/Data/assets/select2/js/select2.min.js"></script>

<script>
    var type = 1
    function ShowFilter() {
        if (type == 1) {
            $('#FilterDiv').show();
            type = 2;
        }
        else {
            $('#FilterDiv').hide();
            type = 1;
        }
    }
</script>

<script>
    $(document).ready(function () {
        GetClassRoom();
        GetSubjectList(1);
        $('#FilterDiv').hide();

    });

    $('.single-select').select2({
        theme: 'bootstrap4',
        SearchText: true,
        width: $(this).data('width') ? $(this).data('width') : $(this).hasClass('w-100') ? '100%' : 'style',
        placeholder: $(this).data('placeholder'),
        allowClear: Boolean($(this).data('allow-clear')),
    });

    function InsertData() {

        var val = true;
        var Id = $('#hdnintId').val();
        var ClassId = $('#ClassId').val();
        var SearchText = $('#SearchText').val();
        var SubjectName = $('#SubjectName').val();
        if (SubjectName == "" || /\S/.test(SubjectName) == false) {
            $("#errSubjectName").html("Please enter SubjectName.");
            val = false;
        }
        else {
            var isValid = SubjectName.match(".*[a-zA-Z]+.*");
            if (isValid == null) {
                $("#errSubjectName").html("Please enter valid SubjectName.");
                val = false;
            }
            else {
                $("#errSubjectName").html("");
            }
        }
        var formData = new FormData();
        if (val == false) {
            return;
        }

        formData.append('Id', Id);
        formData.append('ClassId', ClassId);
        formData.append('SearchText', SearchText);
        formData.append('SubjectName', SubjectName);
        ShowWait();
        $.ajax({
            type: "POST",
            url: '/Subject/InsertSubject',
            contentType: "application/json; charset=utf-8",
            contentType: false,
            processData: false,
            data: formData,
            success: function (data) {
                if (data != null) {
                    if (data == 'Success' && Id == 0) {
                        toastr.success('Subject inserted successfully');
                        GetSubjectList(1);
                        $('#Subject').click();
                        ClearData(1);
                    }
                    else if (data == 'Updated' && Id > 0) {
                        toastr.success('Subject updated successfully');
                        GetSubjectList(1);
                        $('#Subject').click();
                        ClearData(1);
                    }
                    else if (data == 'Exists') {
                        toastr.error('Subject already exists!');
                        document.getElementById('Email').value = "";
                    }
                }
                HideWait();
            },
            error: function (xyz) {
                HideWait();
                alert('errors');
            }
        });
    }

    function GetClassRoom() {
        var cls = {
        }
        $.ajax({
            url: '/Subject/GetClassRoom',
            contentType: "application/json; charset=utf-8",
            type: "GET",
            data: JSON.stringify({
                cls: cls
            }),
            success: function (data) {

                var html = "";
                html = html + ' <option value="0" selected>Select ClassRoom</option>';
                for (var i = 0; i < data.LSTClassRoomList.length; i++) {
                    html = html + '<option value="' + data.LSTClassRoomList[i].Id + '">' + data.LSTClassRoomList[i].ClassNo + '</option>';
                    $("#ClassId").empty();
                    $("#ClassId").append(html);
                    $("#ddlClassId").empty();
                    $("#ddlClassId").append(html);
                }
            }
        });
    }

    function GetSubjectList(page) {

        var Id = 0;
        var SearchText = document.getElementById('SearchText').value;
        var intActive = document.getElementById('intActive').value;
        var ClassId = document.getElementById('ddlClassId').value;
        if (document.getElementById('PageSize') != null) {
            PageSize = document.getElementById('PageSize').value;
        }
        else {
            PageSize = 10;
        }
        if (page == undefined) {
            page = 1;
        }
        var PageIndex = page;

        PageIndex = page;
        var cls = {
            Id: Id,
            SearchText: SearchText,
            intActive: intActive,
            ClassId: ClassId,
            PageSize: PageSize,
            PageIndex: PageIndex,
        }
        ShowWait();
        $.ajax({
            url: '/Subject/GetSubject',
            contentType: "application/json; charset=utf-8",
            type: "POST",
            data: JSON.stringify({
                cls: cls
            }),
            success: function (data) {
                $('#tblBody').empty();
                $('#tblBody').append(data);
                HideWait();
            },
            error: function (xhr) {
                HideWait();
                alert('errors');
            }
        });
    }

    function GetSingleSubjectData(id) {
        $('#errSubjectName').html("");
        document.getElementById('btnAdd').innerHTML = "Update";
        $("#btnAdd").attr('title', 'Update');
        document.getElementById('PopupTitle').innerHTML = "Update Subject";
        var cls = {
            Id: id
        }

        $.ajax({
            url: '/Subject/GetSingleSubjectData',
            contentType: "application/json; charset=utf-8",
            type: "POST",
            data: JSON.stringify({
                cls: cls
            }),
            success: function (data) {

                if (data != null) {
                    document.getElementById('hdnintId').value = data.LSTSubjectList[0].Id;
                    document.getElementById('SubjectName').value = data.LSTSubjectList[0].SubjectName;
                    $('#ClassId').val(data.LSTSubjectList[0].ClassId).trigger("change");
                }
                else {
                    alert('error');
                }

            },
            error: function (xhr) {

                alert('errors');
            }
        });
    }

    function deleteSubject() {
        var Id = document.getElementById('hdnintId').value;
        var cls = {
            Id: Id
        }
        ShowWait();
        $.ajax({
            url: '/Subject/deleteSubject',
            contentType: "application/json; charset=utf-8",
            type: "POST",
            data: JSON.stringify({
                cls: cls
            }),
            success: function (data) {

                if (data.Response == 'Success' && Id > 0) {

                    toastr.success('Subject deleted successfully');
                    document.getElementById('hdnintId').value = "0";
                    GetSubjectList();
                    $('#delete_Subject').click();
                }
                else {
                    alert('error');
                }
                HideWait();
            },
            error: function (xhr) {
                HideWait();
                alert('errors');

            }
        });
    }

    function Clear() {
        document.getElementById('SubjectName').value = "";
        $('#errSubjectName').html("");
        $("#ddlClassId").val('0').trigger('change');
        document.getElementById('btnAdd').innerHTML = "Add";
        $("#btnAdd").attr('title', 'Upload');
        document.getElementById('PopupTitle').innerHTML = "Add Subject";
    }

    function UpdateStatus() {
        var Id = document.getElementById('hdnintId').value;
        var cls = {
            Id: Id
        }
        ShowWait();
        $.ajax({
            url: '/Subject/UpdateStatus',
            contentType: "application/json; charset=utf-8",
            type: "POST",
            data: JSON.stringify({
                cls: cls
            }),
            success: function (data) {
                if (data == 'success') {
                    toastr.success('status updated successfully.');
                    document.getElementById('hdnintId').value = "0";
                    GetSubjectList(1);
                    $('#status').click();
                }
                else if (data == 'Exist') {
                    toastr.error('Exists');
                }
                else {
                    alert('error');
                }
                HideWait();
            },
            error: function (xhr) {
                HideWait();
                alert('errors');
            }
        });
    }

    function ClearData(type) {

        if (type == 1) {
            var Id = document.getElementById('hdnintId').value;
            document.getElementById('SubjectName').value = "";
            $('#errSubjectName').html("");
            $("#ClassId").val('0').trigger('change');

            if (Id == "0") {

                document.getElementById('hdnintId').value = "0";
                document.getElementById('btnAdd').innerHTML = "Add";
                $("#btnAdd").attr('title', 'Add');
                document.getElementById('PopupTitle').innerHTML = "Add Subject";
            }
            else {
                document.getElementById('btnAdd').innerHTML = "Update";
                $("#btnAdd").attr('title', 'Update');
                document.getElementById('PopupTitle').innerHTML = "Update Subject";
            }
        }
        else {
            document.getElementById('SearchText').value = "";
            document.getElementById('intActive').value = '3';
            $("#ddlClassId").val('0').trigger('change');
            GetSubjectList();
        }
    }

    function opendeleteModel(id) {

        document.getElementById('hdnintId').value = id;
    }

    function openstatusModel(id) {

        document.getElementById('hdnintId').value = id;
    }
</script>


